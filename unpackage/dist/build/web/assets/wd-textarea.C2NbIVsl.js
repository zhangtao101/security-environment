import{d as e,W as a,c as l,r as s,w as r,R as o,o as t,a as i,b as n,g as u,j as d,x as c,f,e as m,t as p,n as h,G as g,h as b,X as v}from"./index-4xE3Jiky.js";import{g as x,m as _,c as y,b as w,a as k,B as $,O as C,u as S,n as W,P as V,z as j,h as T,k as q,_ as B}from"./useChildren.ogl1P_NW.js";import{u as I}from"./request.BbQ2wDkA.js";const P=B(e({name:"wd-textarea",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...x,customTextareaContainerClass:_(""),customTextareaClass:_(""),customLabelClass:_(""),modelValue:y(""),placeholder:String,placeholderStyle:String,placeholderClass:_(""),disabled:w(!1),maxlength:k(-1),autoFocus:w(!1),focus:w(!1),autoHeight:w(!1),fixed:w(!1),cursorSpacing:k(0),cursor:k(-1),confirmType:String,confirmHold:w(!1),showConfirmBar:w(!0),selectionStart:k(-1),selectionEnd:k(-1),adjustPosition:w(!0),disableDefaultPadding:w(!1),holdKeyboard:w(!1),showPassword:w(!1),clearable:w(!1),readonly:w(!1),prefixIcon:String,showWordLimit:w(!1),label:String,labelWidth:_(""),size:String,error:w(!1),center:w(!1),noBorder:w(!1),required:w(!1),prop:_(""),rules:$(),clearTrigger:_("always"),focusWhenClear:w(!0),ignoreCompositionEvent:w(!0),inputmode:_("text"),markerSide:_("before")},emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","linechange","clickprefixicon","click"],setup(e,{emit:x}){const{translate:_}=I("textarea"),y=e,w=x,k=a(),$=l((()=>T(y.placeholder)?y.placeholder:_("placeholder"))),B=s(!1),P=s(!1),E=s(!1),H=s(""),L=C();r((()=>y.focus),(e=>{P.value=e}),{immediate:!0,deep:!0}),r((()=>y.modelValue),(e=>{H.value=T(e)?String(e):""}),{immediate:!0,deep:!0});const{parent:z}=S(V),A=l((()=>{const{disabled:e,readonly:a,clearable:l,clearTrigger:s}=y;return!(!l||a||e||!H.value||!("always"===s||"focus"===y.clearTrigger&&E.value))})),F=l((()=>{const{disabled:e,readonly:a,maxlength:l,showWordLimit:s}=y;return Boolean(!e&&!a&&T(l)&&l>-1&&s)})),K=l((()=>z&&y.prop&&z.errorMessages&&z.errorMessages[y.prop]?z.errorMessages[y.prop]:"")),M=l((()=>{let e=!1;if(z&&z.props.rules){const a=z.props.rules;for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&l===y.prop&&Array.isArray(a[l])&&(e=a[l].some((e=>e.required)))}return y.required||y.rules.some((e=>e.required))||e})),O=l((()=>Array.from(String(X(y.modelValue))).length)),D=l((()=>`wd-textarea   ${y.label||k.label?"is-cell":""} ${y.center?"is-center":""} ${L.border.value?"is-border":""} ${y.size?"is-"+y.size:""} ${y.error?"is-error":""} ${y.disabled?"is-disabled":""} ${y.autoHeight?"is-auto-height":""} ${O.value>0?"is-not-empty":""}  ${y.noBorder?"is-no-border":""} ${y.customClass}`));l((()=>`wd-textarea__label ${y.customLabelClass}`));const G=l((()=>`wd-textarea__placeholder  ${y.placeholderClass}`)),R=l((()=>`${O.value>0?"wd-textarea__count-current":""} ${O.value>y.maxlength?"is-error":""}`)),U=l((()=>y.labelWidth?q({"min-width":y.labelWidth,"max-width":y.labelWidth}):""));function X(e){if(null==e)return"";const{maxlength:a,showWordLimit:l}=y;return l&&-1!==a&&String(e).length>a?e.toString().substring(0,a):`${e}`}async function J(){E.value=!1,H.value="",y.focusWhenClear&&(B.value=!0,P.value=!1),await j(),y.focusWhenClear&&(P.value=!0,E.value=!0),w("update:modelValue",H.value),w("clear")}async function N({detail:e}){await j(150),B.value?B.value=!1:(E.value=!1,w("blur",{value:H.value,cursor:e.cursor?e.cursor:null}))}function Q({detail:e}){E.value=!0,w("focus",e)}function Y({detail:e}){H.value=X(H.value),w("update:modelValue",H.value),w("input",e)}function Z({detail:e}){w("keyboardheightchange",e)}function ee({detail:e}){w("confirm",e)}function ae({detail:e}){w("linechange",e)}function le(){w("clickprefixicon")}return o((()=>{H.value=X(H.value),w("update:modelValue",H.value)})),(e,a)=>{const l=g,s=b,r=v;return t(),i(s,{class:h(D.value),style:u(e.customStyle)},{default:n((()=>[e.label||e.$slots.label?(t(),i(s,{key:0,class:"wd-textarea__label",style:u(U.value)},{default:n((()=>[M.value&&"before"===e.markerSide?(t(),i(l,{key:0,class:"wd-textarea__required wd-textarea__required--left"},{default:n((()=>[d("*")])),_:1})):c("",!0),e.prefixIcon||e.$slots.prefix?(t(),i(s,{key:1,class:"wd-textarea__prefix"},{default:n((()=>[e.prefixIcon&&!e.$slots.prefix?(t(),i(W,{key:0,"custom-class":"wd-textarea__icon",name:e.prefixIcon,onClick:le},null,8,["name"])):f(e.$slots,"prefix",{key:1},void 0,!0)])),_:3})):c("",!0),m(s,{class:"wd-textarea__label-inner"},{default:n((()=>[e.label&&!e.$slots.label?(t(),i(l,{key:0},{default:n((()=>[d(p(e.label),1)])),_:1})):e.$slots.label?f(e.$slots,"label",{key:1},void 0,!0):c("",!0)])),_:3}),M.value&&"after"===e.markerSide?(t(),i(l,{key:2,class:"wd-textarea__required"},{default:n((()=>[d("*")])),_:1})):c("",!0)])),_:3},8,["style"])):c("",!0),m(s,{class:h(`wd-textarea__value ${A.value?"is-suffix":""} ${e.customTextareaContainerClass} ${F.value?"is-show-limit":""}`)},{default:n((()=>[m(r,{class:h(`wd-textarea__inner ${e.customTextareaClass}`),modelValue:H.value,"onUpdate:modelValue":a[0]||(a[0]=e=>H.value=e),"show-count":!1,placeholder:$.value,disabled:e.disabled||e.readonly,maxlength:e.maxlength,focus:P.value,"auto-focus":e.autoFocus,"placeholder-style":e.placeholderStyle,"placeholder-class":G.value,"auto-height":e.autoHeight,"cursor-spacing":e.cursorSpacing,fixed:e.fixed,cursor:e.cursor,"show-confirm-bar":e.showConfirmBar,"selection-start":e.selectionStart,"selection-end":e.selectionEnd,"adjust-position":e.adjustPosition,"hold-keyboard":e.holdKeyboard,"confirm-type":e.confirmType,"confirm-hold":e.confirmHold,"disable-default-padding":e.disableDefaultPadding,ignoreCompositionEvent:e.ignoreCompositionEvent,inputmode:e.inputmode,onInput:Y,onFocus:Q,onBlur:N,onConfirm:ee,onLinechange:ae,onKeyboardheightchange:Z},null,8,["class","modelValue","placeholder","disabled","maxlength","focus","auto-focus","placeholder-style","placeholder-class","auto-height","cursor-spacing","fixed","cursor","show-confirm-bar","selection-start","selection-end","adjust-position","hold-keyboard","confirm-type","confirm-hold","disable-default-padding","ignoreCompositionEvent","inputmode"]),K.value?(t(),i(s,{key:0,class:"wd-textarea__error-message"},{default:n((()=>[d(p(K.value),1)])),_:1})):c("",!0),y.readonly?(t(),i(s,{key:1,class:"wd-textarea__readonly-mask"})):c("",!0),m(s,{class:"wd-textarea__suffix"},{default:n((()=>[A.value?(t(),i(W,{key:0,"custom-class":"wd-textarea__clear",name:"error-fill",onClick:J})):c("",!0),F.value?(t(),i(s,{key:1,class:"wd-textarea__count"},{default:n((()=>[m(l,{class:h(R.value)},{default:n((()=>[d(p(O.value),1)])),_:1},8,["class"]),d(" /"+p(e.maxlength),1)])),_:1})):c("",!0)])),_:1})])),_:1},8,["class"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-b73190d0"]]);export{P as _};
