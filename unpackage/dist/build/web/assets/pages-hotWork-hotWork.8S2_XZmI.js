import{_ as e,a,f as l}from"./wd-datetime-picker.CP4rJPdd.js";import{d as t,c as o,w as u,o as s,a as i,b as d,f as r,n,g as c,h as m,r as p,q as f,l as v,e as h,x as _,j as g,y as b,z as V,F as w,t as y}from"./index-4xE3Jiky.js";import{g as L,a as I,u as z,h as U,_ as k,j as x,k as $,f as j,r as C}from"./useChildren.ogl1P_NW.js";import{r as T,a as S,b as q,_ as E,c as N,d as M}from"./request.BbQ2wDkA.js";import{_ as A}from"./wd-textarea.C2NbIVsl.js";import{_ as F,a as G,b as B}from"./wd-select-picker.DCKp3YlI.js";import{_ as O}from"./wd-cell.D49pC09f.js";import{_ as D}from"./wd-upload.r7andDs0.js";import{_ as H}from"./wd-form.D0YxAQUM.js";import{_ as J}from"./wd-message-box.D-XpZhdX.js";import{_ as P}from"./wd-toast.CSdeP_zF.js";import"./index.ClTUV6O_.js";/* empty css                                                               */const R=Symbol("wd-row"),W={...L,gutter:I(0)},Q=k(t({name:"wd-col",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...L,span:I(24),offset:I(0)},setup(e){const a=e,{parent:l}=z(R),t=o((()=>{const e=U(l)&&l.props.gutter||0,t=e/2+"px";return`${e>0?`padding-left: ${t}; padding-right: ${t};background-clip: content-box;`:""}${a.customStyle}`}));return u([()=>a.span,()=>a.offset],(()=>{!function(){const{span:e,offset:l}=a;(e<0||l<0)&&console.error("[wot-design] warning(wd-col): attribute span/offset must be greater than or equal to 0")}()})),(e,a)=>{const l=m;return s(),i(l,{class:n(["wd-col",e.span&&"wd-col__"+e.span,e.offset&&"wd-col__offset-"+e.offset,e.customClass]),style:c(t.value)},{default:d((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-1e54e7b5"]]),K=k(t({name:"wd-row",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:W,setup(e){const a=e,{linkChildren:l}=x(R);l({props:a});const t=o((()=>{const e={},{gutter:l}=a;return l<0?console.error("[wot ui] warning(wd-row): attribute gutter must be greater than or equal to 0"):l&&(e.marginLeft=j(l/2),e.marginRight=j(l/2)),`${$(e)}${a.customStyle}`}));return(e,a)=>{const l=m;return s(),i(l,{class:n(`wd-row ${e.customClass}`),style:c(t.value)},{default:d((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-07de7f75"]]),X=k({__name:"hotWork",setup(t){const o=p({dateTime:[Date.now(),""],hazardsourceIdentificationList:["其他"],hazardIdentificationList:["其他"],type:""}),u=p(),r=p(!1);function n(){u.value.validate().then((()=>{const e={...o.value};e.hazardsourceIdentificationList&&e.hazardsourceIdentificationList.includes("其他")&&e.hazardsourceIdentificationList_other&&(e.hazardsourceIdentificationList=[...e.hazardsourceIdentificationList,...e.hazardsourceIdentificationList_other.split(",")]),e.hazardIdentificationList&&e.hazardIdentificationList.includes("其他")&&e.hazardIdentificationList_other&&(e.hazardIdentificationList=[...e.hazardIdentificationList,...e.hazardIdentificationList_other.split(",")]),e.dateTime&&2===e.dateTime.length&&(e.startTime=l(e.dateTime[0]),e.endTime=l(e.dateTime[1])),Z.value.forEach((a=>{if(e.fileList=[],a.response){const l=JSON.parse(a.response);e.fileList.push(l.data)}})),Y.value.forEach((a=>{if(e.photoList=[],a.response){const l=JSON.parse(a.response);e.photoList.push(l.data)}})),r.value=!0,T({url:`/${N.mesMain}/hotwork/apply/insert`,data:e,needAuth:!1,method:"POST"}).then((()=>{M("操作成功"),setTimeout((()=>{location.reload()}),500)})).finally((()=>{r.value=!1}))}))}const c=p([{label:"请先选择申请部门",value:-1}]);function L({value:e,selectedItems:{charge:a}}){console.log(a,e),o.value.departSupervisor=a,T({url:`/${N.mesMain}/basic/area/getByDepart/${e}`,data:{},needAuth:!1,method:"GET"}).then((e=>{c.value=[],e.forEach((e=>{c.value.push({label:e,valueu:e})}))}))}const I=p([]);const z=p([{label:"一级",value:1},{label:"二级",value:2},{label:"三级",value:3}]),U=p([{label:"易燃易爆危险品",value:"易燃易爆危险品"},{label:"油漆",value:"油漆"},{label:"油类",value:"油类"},{label:"电器设备",value:"电器设备"},{label:"压力容器",value:"压力容器"},{label:"彩钢板",value:"彩钢板"},{label:"木材",value:"木材"},{label:"油回丝等",value:"油回丝等"},{label:"其他",value:"其他"}]),k=p([{label:"火灾",value:"火灾"},{label:"爆炸",value:"爆炸"},{label:"触电",value:"触电"},{label:"高处坠落",value:"高处坠落"},{label:"其他",value:"其他"}]),x=p(!1),$=p([]),j=p("");function R(){T({url:`/${N.mesUser}/sys/word/listWordListByParentCode/AQCS`,data:{},needAuth:!1,method:"GET"}).then((e=>{$.value=[],e.forEach((e=>{$.value.push({securityMeasure:e.wordName,confirm:!1})}))})).finally((()=>{})),x.value=!0}function W(){x.value=!1,j.value="",$.value=[]}function X(){o.value.safeIdList=[],o.value.remark=j.value,$.value.forEach((e=>{o.value.safeIdList.push(e.securityMeasure)})),W()}const Y=p([]),Z=p([]),ee=`${N.baseURL}/${N.mesMain}/accident/register/uploadFile`;return f((()=>{T({url:`/${N.mesUser}/sys/organization/listByName`,data:{orgName:""},needAuth:!1,method:"GET"}).then((e=>{e&&(I.value=[],e.forEach((e=>{I.value.push({label:e.orgFullName,value:e.orgFullName,charge:e.charge})})))})).finally((()=>{}))})),(l,t)=>{const p=C(v("wd-picker"),e),f=C(v("wd-input"),S),T=C(v("wd-datetime-picker"),a),N=C(v("wd-textarea"),A),M=C(v("wd-select-picker"),F),ae=C(v("wd-button"),q),le=C(v("wd-cell"),O),te=C(v("wd-upload"),D),oe=m,ue=C(v("wd-form"),H),se=C(v("wd-col"),Q),ie=C(v("wd-row"),K),de=C(v("wd-radio"),G),re=C(v("wd-radio-group"),B),ne=C(v("wd-popup"),E),ce=C(v("wd-message-box"),J),me=C(v("wd-toast"),P);return s(),i(oe,null,{default:d((()=>[h(oe,null,{default:d((()=>[h(ue,{ref_key:"form",ref:u,model:o.value,border:""},{default:d((()=>[h(p,{"align-right":"",columns:I.value,label:"申请部门",modelValue:o.value.department,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value.department=e),onConfirm:L},null,8,["columns","modelValue"]),h(f,{"align-right":"",label:"部门管理员",type:"text",modelValue:o.value.departSupervisor,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value.departSupervisor=e),readonly:""},null,8,["modelValue"]),h(f,{"align-right":"",label:"动火车间",type:"text",modelValue:o.value.workshop,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.workshop=e)},null,8,["modelValue"]),h(p,{"align-right":"",prop:"location",columns:c.value,label:"动火部位",modelValue:o.value.location,"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.location=e),placeholder:"请选择动火部位",disabled:!o.value.department,rules:[{required:!0,message:"请选择动火部位"}]},null,8,["columns","modelValue","disabled"]),h(p,{"align-right":"",columns:z.value,label:"动火级别",modelValue:o.value.level,"onUpdate:modelValue":t[4]||(t[4]=e=>o.value.level=e)},null,8,["columns","modelValue"]),h(T,{label:"动火时间","align-right":"",modelValue:o.value.dateTime,"onUpdate:modelValue":t[5]||(t[5]=e=>o.value.dateTime=e),rules:[{required:!0,message:"请填写动火时间"}]},null,8,["modelValue"]),h(N,{"align-right":"",label:"动火内容",modelValue:o.value.content,"onUpdate:modelValue":t[6]||(t[6]=e=>o.value.content=e),placeholder:"请填写详细的动火内容",maxlength:300,clearable:"","show-word-limit":""},null,8,["modelValue"]),h(f,{"align-right":"",label:"动火设备",modelValue:o.value.equipment,"onUpdate:modelValue":t[7]||(t[7]=e=>o.value.equipment=e),placeholder:"请填写详细的动火设备",clearable:""},null,8,["modelValue"]),h(M,{"align-right":"",label:"危险源识别",modelValue:o.value.hazardsourceIdentificationList,"onUpdate:modelValue":t[8]||(t[8]=e=>o.value.hazardsourceIdentificationList=e),columns:U.value},null,8,["modelValue","columns"]),o.value.hazardsourceIdentificationList&&o.value.hazardsourceIdentificationList.includes("其他")?(s(),i(f,{key:0,"align-right":"",label:"危险源识别-其他",type:"text",modelValue:o.value.hazardsourceIdentificationList_other,"onUpdate:modelValue":t[9]||(t[9]=e=>o.value.hazardsourceIdentificationList_other=e),placeholder:"用英文状态的,分隔"},null,8,["modelValue"])):_("",!0),h(M,{"align-right":"",label:"危险辨识",modelValue:o.value.hazardIdentificationList,"onUpdate:modelValue":t[10]||(t[10]=e=>o.value.hazardIdentificationList=e),columns:k.value},null,8,["modelValue","columns"]),o.value.hazardIdentificationList&&o.value.hazardIdentificationList.includes("其他")?(s(),i(f,{key:1,"align-right":"",label:"危险辨识-其他",type:"text",modelValue:o.value.hazardIdentificationList_other,"onUpdate:modelValue":t[11]||(t[11]=e=>o.value.hazardIdentificationList_other=e),placeholder:"用英文状态的,分隔"},null,8,["modelValue"])):_("",!0),h(le,{title:"安全措施确认",top:""},{default:d((()=>[h(ae,{onClick:R},{default:d((()=>[g(" 安全措施确认 ")])),_:1})])),_:1}),h(f,{"align-right":"",label:"动火人",type:"text",modelValue:o.value.hotworkUser,"onUpdate:modelValue":t[12]||(t[12]=e=>o.value.hotworkUser=e)},null,8,["modelValue"]),h(f,{"align-right":"",label:"特种作业操作证号或工作证号",type:"text",modelValue:o.value.certificateCode,"onUpdate:modelValue":t[13]||(t[13]=e=>o.value.certificateCode=e),placeholder:"请输入"},null,8,["modelValue"]),h(f,{"align-right":"",label:"现场监护人",type:"text",modelValue:o.value.guardian,"onUpdate:modelValue":t[14]||(t[14]=e=>o.value.guardian=e),placeholder:"请输入"},null,8,["modelValue"]),h(f,{"align-right":"",label:"现场指挥",type:"text",modelValue:o.value.siteSupervisor,"onUpdate:modelValue":t[15]||(t[15]=e=>o.value.siteSupervisor=e),placeholder:"请输入"},null,8,["modelValue"]),h(le,{title:"资料上传(图片)",top:""},{default:d((()=>[h(te,{"file-list":Y.value,"onUpdate:fileList":t[16]||(t[16]=e=>Y.value=e),"image-mode":"aspectFill",action:ee},null,8,["file-list"])])),_:1}),h(le,{title:"资料上传(文件)",top:""},{default:d((()=>[h(te,{"file-list":Z.value,"onUpdate:fileList":t[17]||(t[17]=e=>Z.value=e),accept:"all",multiple:"",action:ee},null,8,["file-list"])])),_:1}),h(oe,{class:"footer"},{default:d((()=>[h(ae,{type:"primary",size:"large",onClick:n,block:"",loading:r.value},{default:d((()=>[g("提交")])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])),_:1}),h(ne,{modelValue:x.value,"onUpdate:modelValue":t[19]||(t[19]=e=>x.value=e),position:"bottom","close-on-click-modal":!1,closable:"","custom-style":"height: 60%;",onClose:W,class:"security_measure"},{default:d((()=>[h(oe,{class:"security_measure_view"},{default:d((()=>[h(ie,{class:"security_measure_header"},{default:d((()=>[h(se,{span:2},{default:d((()=>[h(oe,null,{default:d((()=>[g("序号")])),_:1})])),_:1}),h(se,{span:13},{default:d((()=>[h(oe,null,{default:d((()=>[g("安全措施")])),_:1})])),_:1}),h(se,{span:9},{default:d((()=>[h(oe,null,{default:d((()=>[g("确认")])),_:1})])),_:1})])),_:1}),(s(!0),b(w,null,V($.value,((e,a)=>(s(),i(ie,{class:"security_measure_row",key:a},{default:d((()=>[h(se,{span:2,class:"security_measure_item"},{default:d((()=>[h(oe,null,{default:d((()=>[g(y(a+1),1)])),_:2},1024)])),_:2},1024),h(se,{span:13,class:"security_measure_item"},{default:d((()=>[h(oe,null,{default:d((()=>[g(y(e.securityMeasure),1)])),_:2},1024)])),_:2},1024),h(se,{span:9,class:"security_measure_item"},{default:d((()=>[h(re,{modelValue:e.confirm,"onUpdate:modelValue":a=>e.confirm=a,shape:"dot",inline:""},{default:d((()=>[h(de,{value:!0},{default:d((()=>[g("通过")])),_:1}),h(de,{value:!1},{default:d((()=>[g("不通过")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128)),h(N,{"align-right":"",label:"备注",modelValue:j.value,"onUpdate:modelValue":t[18]||(t[18]=e=>j.value=e),placeholder:"请填写备注信息",maxlength:300,clearable:"","show-word-limit":"",style:{"margin-top":"1rem"}},null,8,["modelValue"]),h(oe,{class:"footer"},{default:d((()=>[h(ae,{type:"primary",size:"large",onClick:X,bloc:""},{default:d((()=>[g("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),h(ce),h(me)])),_:1})}}},[["__scopeId","data-v-cee3e5ce"]]);export{X as default};
